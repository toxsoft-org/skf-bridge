new

Максим привет!
   Дополнение к пред. письму.
Сейчас у нас автоматически генерится в файл *.devcfg следующая информация
DeviceConfig =
{
  false,
  "opc2s5.cfg",
  {
    javaClassName = "ru.toxsoft.bkn.l2.thd.opc.BknOpcUaMiloDriverProducer", 
Это мы тупо сделали заплатку для проекта Байконур
Надо чтобы генератор, используя знание о текущем типе дерева OPC UA подставлял правильный  Producer.
1. Байконура -  ru.toxsoft.bkn.l2.thd.opc.BknOpcUaMiloDriverProducer
2. Polygone проектов  - org.toxsoft.l2.thd.opc.ua.milo.OpcUaMiloDriverProducer
3. для остальных Сименсов пока пусть тоже будет из п.2

Максим привет!
   Я надеюсь что ты хорошо отдохнул и готов подставить свои могучие плечи под subj.
Поехали.
   Пока парни в отпуске, мы (я, Сергей, Андрей)т  поставили проект НМ на паузу и занялись проектом Казахстан-Ветрол. Этот проект типовой для нас, очень похож на Губаху. 
На контроллере Poligon и OPC UA сервер, далее Uskat стек (мост, сервер, АРМ).
На реализации этого проект я занимался отладкой  новых кодов реализующих паттерн Strategy. На текущий момент заработал функционал генерации системного описания (классы и объекты). Теперь нужно сгенерить конфигурационные файлы для моста и отлаживать всю цепочку (контроллер - мост - сервер - АРМ).

Постановка задачи.
Код автоматической привязки node -> Gwids,    StoredMetaInfoAutoLinkConfigurationProcess:: formCfgUnitsFromAutoElements(...)
Сейчас в нем поставлена заплатка для работы с проектом Байконур (см.    // Max for bkn ) 
Надо сделать так чтобы код использовал информацию из аргумента conConf (  OpcUaServerConnCfg::EOPCUATreeType treeType() )
и генерил соответв. связи.
На текущий момент у нас зафиксировано:
1.  тип Сименс-Байконур:
- простые команды
- нет НСИ
2. типа Poligon:
- команды и НСИ через комплексный тег
3. Сименс (не Байконур) :
- пока не известно, склоняемся к использованию комплексного тега
Кивни что принял и/или набери меня в любое время, я не в отпуске (пока или еще :-)


-------------------------------------------------------------

TODO:
+1. продумать как указать файлы команд и битовых свойств
2. чистить metainfo при удалении объектов
+3. дописать документ "OPC UA configurer, under the hood"
+4. проверить создание одного класса и одного объекта и их вклад в весомость dlmcfg and devcfg
+5. проверить обновленеи одного класса и нескольких объектов 
+6. Max, конфигурация dev|dlmcfg, не интуитивное название и процесс создания, что такое NodeId ? и зачем его отображать
+7. использование имени при гененрации
+8. ввод пути к директории вывода через выбор диалога пути
+9. генерация узлов автоматически, а не руками
+10. автоподтягивание информации о OPC UA NodeI
+11. бегунок при автогенерации руками на обоих закладках
12. 
 
1 task:

 В генераторе devcfg нужно подставлять реальный IP взятый из описания соединения с OPC UA сервером.
Речь вот об этом:
  id = "opc2s5.bridge.collection.id",
            description = "opc 2 s5 pins UA apparat producer",
            host = "opc.tcp://192.168.12.61:4840",
            user = "",
            password = ""
            
            
2 task:

 Разгребаю авгиевы конюшню, первое что прошу тебя сделать по генератору конфигурации.
Вот эту заплатку сделать по нормальному, OpcToS5DataCfgConverter::createRriAttrs()
начиная с строки  366 // TODO заполним описание настройки для модуля в целом
Это мой костыль для конфигурирования специального блока кода который следит за флагом "Нужен НСИ с сервера USkat".
Щас тупо вставлены нужные данные руками.

Сделать нужно следующее:
- задать device комплексного тега - девайс у нас один
- задать обычный тег на чтение "флаг НСИ" (это тег который сопоставлен с Gwid CtrlSystem[CtrlSystem]rtd(rtdStatusRRI))
- задать код сброса флага (получить из справочника Cmd_OPCUA, strid CtrlSystem.ResetRRI )  
- задать код установки флага (получить из справочника Cmd_OPCUA, strid CtrlSystem.SetRRI )  
- задать комплексны тег ( это комплексный тег для всех команд CtrlSystem[CtrlSystem] )
Пример как работать со справочником см. OpcUaUtils::readClass2CmdIdx()
И еще одно,
  пока писал письмо обнаружил что в отправленном тебе системном описании нет объектов класса CtrlSystem.
Я тупо забыл его сгенерить. Щас перегенерю и отправлю.